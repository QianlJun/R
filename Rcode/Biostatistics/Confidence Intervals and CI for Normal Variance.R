S2<-105.977^2
n<-513
alpha<-0.05
qtiles<-qchisq(c(alpha/2,1-alpha/2),n-1)
ival<-rev((n-1)*S2/qtiles)
sqrt(ival)
sigmaVals<-seq(90,120,length=1000)
likeVals<-dgamma((n-1)*S2,shape=(n-1)/2,scale=2*sigmaVals^2)
likeVals<-likeVals/max(likeVals)
plot(sigmaVals,likeVals,type="l")
lines(range(sigmaVals[likeVals>=1/8]),c(1/8,1/8))
lines(range(sigmaVals[likeVals>=1/16]),c(1/16,1/16))
data(sleep)
g1<-sleep$extra[1:10]
g2<-sleep$extra[11:20]
difference<-g2-g1
mn<-mean(difference)
s<-sd(difference)
n<-10
mn+c(-1,1)*qt(0.975,n-1)*s/sqrt(n)
t.test(difference)$conf.int
##Starting after the code for the t interval
tStat<-sqrt(n)*mn/s
esVals<-seq(0,3,length=1000)
likVals<-dt(tStat,n-1,ncp=sqrt(n)*esVals)
likVals<-likVals/max(likVals)
plot(esVals,likVals,type="l")
lines(range(esVals[likVals>1/8]),c(1/8,1/8))
lines(range(esVals[likVals>1/16]),c(1/16,1/16))