GRCh37：
GRC是Genome Reference Consortium（基因组参照序列联盟）的简称
h37是指Human Genome Build 37，即人类基因组组装（Assembly）的版本37
1 匹配概率加权函数
我们首先要依靠基因的长度知道每个基因的加权，长度数据可从本地数据库获得。
我们让  goseq 在数据库中自动抓取数据。
2 华伦逼近
在开始默认的分析方法之前，要计算在差异表达基因中过表达和低表达的GO类别。
同样用goseq自动抓取数据，不过这次是对应ID和GO类别之间的关系


library(edgeR)
 table.summary=read.table(system.file("extdata","Li_sum.txt",package='goseq'),
+ sep='\t',header=TRUE,stringsAsFactors=FALSE)
 counts=table.summary[,-1]
 rownames(counts)=table.summary[,1]
 grp=factor(rep(c("Control","Treated"),times=c(4,3)))（设计模型的时候为什么是4:3，因为4个控制组，3个实验组）
 summarized=DGEList(counts,lib.size=colSums(counts),group=grp)
 disp=estimateCommonDisp(summarized)
 disp$common.dispersion
 tested=exactTest(disp)
 topTags(tested)（前十的差异表达基因）



有了前十的差异表达基因，要把这些基因挑出来，所有有了下面的操作

 genes=as.integer(p.adjust(tested$table$PValue[tested$table$logFC!=0],
+ method="BH")<.05)（所有P<0.05的基因都设为差异表达基因）

0代表非差异表达基因，1代表差异表达基因

 names(genes)=row.names(tested$table[tested$table$logFC!=0,])
 table(genes)


 library(goseq)
 head(supportedGenomes())[,1:4]

函数，supportedGenomes,人类的基因好找，小鼠的基因要自己找

 head(supportedGeneIDs(),n=12)[,1:4]
 pwf=nullp(genes,"hg19","ensGene")
 head(pwf)

看是不是差异表达，可以发现前几个都不是差异表达基因

 source("http://bioconductor.org/biocLite.R")
 biocLite("org.Hs.eg.db")

注释数据库，解释某个基因是不是某个成分

 GO.wall=goseq(pwf,"hg19","ensGene")
 head(GO.wall)

短的文字是GoID的解释

bp,分子生物过程
cc,分子成分
MF，分子功能

 GO.MF=goseq(pwf,"hg19","ensGene",test.cats=c("GO:MF"))

把所有MF换成CC，即获得分子组成

 head(GO.MF)

Doid代表结构分子的活性，后面的术语是前面分子的解释

 enriched.GO=GO.wall$category[p.adjust(GO.wall$over_represented_pvalue,
+ method="BH")<.05]

富集功能

 head(enriched.GO)
 library(GO.db)
 for(go in enriched.GO[1:10]){      （第一到第十个，GOID术语是什么，术语哪个本体论，
+ print(GOTERM[[go]])
+ cat("--------------------------------------\n")
+ }

}可用于结束语句


一定要选对正确的数据库，以及与GOID对应的数据库
